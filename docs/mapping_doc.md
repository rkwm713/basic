### Katapult → “MakeReady Report” template mapping guide

| Excel field                                                            | Where it lives in the Katapult JSON                                                                                                                                                                                                                                                                   | Notes on extraction / transforms                                                                                                                                                                                                          |
| ---------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **A – Operation Number**                                               | `node.attributes.OP_number["-Imported"]` (or the single key that sits under `OP_number`)                                                                                                                                                                                                              | Always a string; keep the exact value.                                                                                                                                                                                                    |
| **B – Attachment Action**<br>*(I = Install, R = Remove, E = Existing)* | Compare each **attachment** listed under the pole’s `wire`, `equipment`, `guying`, or `riser` blocks:  <br>- If element has **`"proposed":true`**  ➜ **I**  <br>- If element has **`"mr_move"`** but the element is **absent** in the latest design  ➜ **R**  <br>- Otherwise it is existing ➜ **E**. | For wires and risers the “proposed” flag is explicit; for guys it appears as `proposed_anchor_id` on the guy or by a separate anchor node whose `button` is `"anchor"` with `connection_type.button_added : "down guy" / "overhead guy"`  |
| **C – Pole Owner**                                                     | `node.attributes.pole_owner.multi_added`                                                                                                                                                                                                                                                              | Typically `"CPS Energy"`.                                                                                                                                                                                                                 |
| **D – Pole #**                                                         | Prefer `node.attributes.pole_tag["-Imported"].tagtext`; fallback to `PL_number` or `PoleNumber`.                                                                                                                                                                                                      | Strips the “PL” prefix only if you want bare digits.                                                                                                                                                                                      |
| **E – Pole Structure**                                                 | Concatenate `pole_height.one`, `"-"`, `pole_class.one`, space, `pole_species.one` (e.g. **`45-2 Southern Pine`**)                                                                                                                                                                                     | Matches CPS format “HEIGHT-CLASS SPECIES”.                                                                                                                                                                                                |
| **F – Proposed Riser (Y/N)**                                           | `node.attributes.riser.button_added` ➜ **"Yes"** when value ≠ `"No"`                                                                                                                                                                                                                                  | A riser that is *only* in the proposed design will also carry `"proposed": true` inside a `riser` element under `wire/equipment`; treat that as **Yes**.                                                                                  |
| **G – Proposed Guy (Y/N)**                                             | Search the pole’s **child anchor nodes** (`button:"anchor"`) whose `attributes.node_type.button_added` = `"Down Guy"` / `"Overhead Guy"` and which contain **`"proposed_anchor_id"`** or **`"proposed":true`** ➜ **Yes**.  Otherwise **No**.                                                          |                                                                                                                                                                                                                                           |
| **H – PLA % (with proposed attachments)**                              | `node.attributes.final_passing_capacity_%.*` (single child key)                                                                                                                                                                                                                                       | Convert to number; keep one decimal place as in template.                                                                                                                                                                                 |
| **I – Construction Grade of Analysis**                                 | `node.attributes.pole_class.one`                                                                                                                                                                                                                                                                      | Maps directly to CPS “Construction grade” column.                                                                                                                                                                                         |
| **J – Existing Mid-Span – Lowest Com Height**                          | In every **mid-span section** (`connections.*.sections.*` where `node_id_1` ≠ target pole and `node_id_2` ≠ target pole) take each `wire` child whose trace belongs to a **Communication** attachment and read `_measured_height`; record the **minimum** value.                                      | Heights are stored in *inches* above survey origin; divide by 12 and round to the nearest 0.1 ft before writing to the sheet.                                                                                                             |
| **K – Existing Mid-Span – Lowest CPS Electrical**                      | Same loop as (J) but restrict to wires whose trace belongs to the **CPS electrical phase or neutral**; again take the minimum `_measured_height`.                                                                                                                                                     | Convert inches➜feet the same way.                                                                                                                                                                                                         |
| **L – Make-Ready Attacher Description**                                | From `node.attributes.kat_MR_notes.*` capture the first line up to the first line-break, **or** concatenate all unique `attacher_list.*.attachers` values.                                                                                                                                            | Shows who will perform the MR work (Charter, AT\&T, CPS, etc.).                                                                                                                                                                           |
| **M – Make-Ready Existing Height**                                     | For the **specific attachment being moved** find its current `_measured_height` (before `mr_move`).                                                                                                                                                                                                   | Leave blank when action = Install.                                                                                                                                                                                                        |
| **N – Make-Ready Proposed Height**                                     | Proposed height = Existing `_measured_height` **+** `mr_move` (note: `mr_move` may be string, cast to number).                                                                                                                                                                                        |                                                                                                                                                                                                                                           |
| **O – Mid-Span Proposed Height**                                       | If the attachment that triggered the move is also present in a *mid-span* section, compute the same formula there; otherwise leave blank.                                                                                                                                                             |                                                                                                                                                                                                                                           |

#### Implementation tips

* **Navigating the JSON** – Katapult stores each pole (and anchor, down-guy, etc.) as a *node*; every object you need is under `job["nodes"]` keyed by an opaque id.  Loop the nodes, pick those with `node_type = "pole"` when filling the main rows.
* **Units** – All `_measured_height` and `mr_move` values are inches above local survey datum.  Converting → feet keeps the Excel layout consistent with CPS requirements.
* **Missing data** – The template prefers blanks over “N/A”; if a field is truly absent, write an empty string so the macro the CPS sheet uses will still run.
* **Speed** – Read the Excel once with `openpyxl`, keep a lookup from column letter to header so you can auto-fill by name instead of hard-coding column numbers.

This guide should let your script pull the right bits out of the Katapult JSON and drop them into the **excel\_details\_makereadyreport.xlsx** template one pole (row) at a time.
